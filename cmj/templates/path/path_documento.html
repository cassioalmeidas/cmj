{% extends "base_path.html" %}
{% load i18n sigad_filters %}

{% block base_functions %}
  {% if next %}
    <div class="path-direction path-next">
      <a href="{% url 'cmj.sigad:path_view' next.absolute_slug %}">
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <div class="inner">
        <div class="titulo">
          <a href="{% url 'cmj.sigad:path_view' next.absolute_slug %}">
            {{next.titulo}}
          </a>
        </div>

          {% if next.childs.view_childs.first.tipo == next.childs.view_childs.first.TPD_IMAGE %}
            <div class="path-imagem {{next.childs.view_childs.first.midia.last.css_class}} img128">
              <img src="/{{next.childs.view_childs.first.absolute_slug}}.128" alt="" />
            </div>
          {% endif %}

            {% with next.parlamentares.count as count_parlamentares %}
              {% for parlamentar in next.parlamentares.all %}

                {% if forloop.counter0 > 0 and forloop.counter0|organize_direction_avatars:count_parlamentares  %}
                  </div>
                {% endif %}

                {% if forloop.counter0|organize_direction_avatars:count_parlamentares %}
                  <div class="path-parlamentares">
                {% endif %}

                  {% if parlamentar.fotografia %}
                    <a class="avatar" href="#">
                      <img src="{{ parlamentar.fotografia.url }}">
                    </a>
                  {% endif %}

                {% if not forloop.last %}
                  <span class="linebreak"></span>
                {% else %}
                  </div>
                {% endif %}

              {% endfor %}
            {% endwith %}
        <div class="descricao">
          {{next.descricao}}
        </div>
      </div>
    </div>
  {% endif %}

  {% if previous %}
    <div class="path-direction path-previous">
      <a href="{% url 'cmj.sigad:path_view' previous.absolute_slug %}">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
      </a>
      <div class="inner">
        <div class="titulo">
          <a href="{% url 'cmj.sigad:path_view' previous.absolute_slug %}">
            {{previous.titulo}}
          </a>
        </div>

          {% if previous.childs.view_childs.first.tipo == previous.childs.view_childs.first.TPD_IMAGE %}
            <div class="path-imagem {{previous.childs.view_childs.first.midia.last.css_class}} img128">
              <img src="/{{previous.childs.view_childs.first.absolute_slug}}.128" alt="" />
            </div>
          {% endif %}


            {% with previous.parlamentares.count as count_parlamentares %}
              {% for parlamentar in previous.parlamentares.all %}

                {% if forloop.counter0 > 0 and forloop.counter0|organize_direction_avatars:count_parlamentares  %}
                  </div>
                {% endif %}

                {% if forloop.counter0|organize_direction_avatars:count_parlamentares %}
                  <div class="path-parlamentares">
                {% endif %}

                  {% if parlamentar.fotografia %}
                    <a class="avatar" href="#">
                      <img src="{{ parlamentar.fotografia.url }}">
                    </a>
                  {% endif %}

                {% if not forloop.last %}
                  <span class="linebreak"></span>
                {% else %}
                  </div>
                {% endif %}

              {% endfor %}
            {% endwith %}
        <div class="descricao">
          {{previous.descricao}}
        </div>
      </div>
    </div>
  {% endif %}
{% endblock %}

{% block base_header %}


{% with object.parlamentares.count as count_parlamentares %}
  {% for parlamentar in object.parlamentares.all %}

    {% if forloop.counter0 > 0 and forloop.counter0|organize_avatars:count_parlamentares %}
      </div>
    {% endif %}

    {% if forloop.counter0|organize_avatars:count_parlamentares %}
      <div class="path-parlamentares">
    {% endif %}

      {% if parlamentar.fotografia %}
        <a class="avatar avatar{% if count_parlamentares >= 5 %}5{%else%}{{count_parlamentares}}{% endif %}" href="#">
          <img src="{{ parlamentar.fotografia.url }}">
        </a>
      {% endif %}

    {% if not forloop.last %}
      <span class="linebreak"></span>
    {% else %}
      </div>
    {% endif %}

  {% endfor %}
{% endwith %}

  {{block.super}}
{% endblock %}

{% block base_content %}
  {% block controls_content %}
    {% if perms.sigad.change_documento %}
      <a href="{% url 'cmj.sigad:documento_edit' object.id %}">{% trans "[Editar]" %}</a>
    {% endif %}
      {% if perms.sigad.delete_documento %}
        <a href="{% url 'cmj.sigad:documento_delete' object.id %}">{% trans "[Excluir]" %}</a>
      {% endif %}
  {% endblock %}
  {% block render_content %}


  {% for child in object.childs.view_childs %}
    {% if child.tipo == child.TPD_TEXTO %}
      {{child.texto|safe}}
    {%elif child.tipo == child.TPD_IMAGE %}
      <div class="path-imagem {{child.midia.last.css_class}}">
        <img src="/{{child.absolute_slug}}.512" alt="" />
      </div>
      {%elif child.tipo == child.TPD_CONTAINER %}
        {% with child as container %}
          {% include "path/path_galeria.html" %}
        {% endwith %}
    {% endif %}

  {% endfor %}

  {% endblock %}
{% endblock %}

{% block cmj_extra_content %}
  <div class="container-fluid container-footer">
    <div class="container  container{{path}}">
      {% with 'path-item-list col-lg-3' as css_class %}
        {% include "path/path_list_docs.html" %}
      {% endwith %}
    </div>
  </div>
{% endblock %}
